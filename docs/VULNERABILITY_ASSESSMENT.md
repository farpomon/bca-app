# Vulnerability Assessment & Penetration Testing Procedures

**Building Condition Assessment System**  
**City of [Municipality] - IT Security Team**  
**Version 1.0**  
**Date: December 2024**

---

## Purpose

This document outlines the procedures for conducting vulnerability assessments and penetration testing of the Building Condition Assessment (BCA) System. It defines the scope, methodology, coordination requirements, and reporting procedures for security assessments conducted by both the vendor (Manus) and the City's IT security team.

---

## 1. Vulnerability Assessment Rights

### 1.1 City Assessment Rights

The City reserves the right to conduct independent security assessments of the BCA system at any time during the contract period. Assessment rights include:

**Vulnerability Scanning**: The City may perform automated vulnerability scans using industry-standard tools (Nessus, Qualys, OpenVAS) to identify security weaknesses in the application, infrastructure, and network configuration.

**Penetration Testing**: The City may conduct manual penetration testing to validate vulnerabilities and assess the effectiveness of security controls. Testing may include network penetration, web application testing, API security testing, and social engineering assessments.

**Source Code Review**: Upon request, the City may review application source code to identify security vulnerabilities, insecure coding practices, and compliance with secure development standards.

**Configuration Audits**: The City may audit system configurations including server hardening, database security settings, network segmentation, and access controls to ensure compliance with security best practices.

### 1.2 Vendor Cooperation

The vendor (Manus) commits to full cooperation with City-conducted security assessments:

- **Access Provision**: Provide necessary access credentials, API keys, and documentation to facilitate testing
- **Technical Support**: Assign technical personnel to answer questions and provide system architecture information
- **Timely Response**: Respond to assessment findings within agreed timelines
- **Remediation Commitment**: Address identified vulnerabilities according to severity-based remediation schedules

---

## 2. Assessment Coordination

### 2.1 Advance Notification

To minimize disruption to production services and ensure proper coordination, the City will provide advance notification before conducting security assessments:

**Minimum Notice Period**: 2 weeks (14 calendar days) for production environment testing  
**Shorter Notice**: 1 week for non-production environment testing  
**Emergency Assessments**: May be conducted with 48 hours notice in response to security incidents or threat intelligence

**Notification Contents**:
- Assessment scope and objectives
- Testing methodology and tools
- Expected start and end dates
- Personnel conducting the assessment
- Contact information for coordination

### 2.2 Testing Environment Preferences

**Non-Production Testing**: Whenever possible, security assessments should be conducted in non-production environments (staging, development) to avoid impact on operational services. The vendor will maintain non-production environments that mirror production configuration.

**Production Testing**: When production testing is necessary (to validate real-world security posture), testing will be scheduled during maintenance windows or low-usage periods. Destructive tests (denial of service, data corruption) are prohibited in production.

**Isolated Testing**: For high-risk tests, the vendor may provision isolated test environments with production-equivalent configurations and representative data (sanitized to remove sensitive information).

### 2.3 Rules of Engagement

Security assessments must follow agreed rules of engagement to ensure safety and legality:

**Authorized Scope**: Testing is limited to systems, networks, and applications explicitly included in the assessment scope. Unauthorized testing of out-of-scope systems is prohibited.

**Data Protection**: Testers must not access, modify, or exfiltrate production data except as necessary for demonstrating vulnerabilities. Any accessed data must be handled according to City data classification policies.

**Denial of Service**: Tests that intentionally cause service outages or performance degradation require explicit approval and must be conducted in non-production environments.

**Social Engineering**: Social engineering tests (phishing, pretexting) targeting vendor personnel require advance approval and must comply with employment laws and ethical guidelines.

**Legal Compliance**: All testing activities must comply with applicable laws including computer fraud and abuse statutes, privacy regulations, and contractual agreements.

---

## 3. Vulnerability Scanning

### 3.1 Vendor-Conducted Scanning

The vendor conducts regular automated vulnerability scanning as part of ongoing security operations:

**Scanning Frequency**:
- **Weekly Scans**: Automated vulnerability scans of all production infrastructure
- **Pre-Deployment Scans**: Mandatory scans before deploying new code or infrastructure changes
- **On-Demand Scans**: Triggered by security advisories or threat intelligence

**Scanning Tools**:
- Network vulnerability scanners (Nessus, Qualys, OpenVAS)
- Web application scanners (OWASP ZAP, Burp Suite)
- Container image scanners (Trivy, Clair)
- Dependency vulnerability scanners (npm audit, Snyk)

**Scan Coverage**:
- External-facing web applications and APIs
- Internal application servers and databases
- Network infrastructure (firewalls, load balancers, routers)
- Operating systems and system services
- Application dependencies and third-party libraries

### 3.2 City-Conducted Scanning

The City may conduct independent vulnerability scans using its own tools and methodologies:

**Scan Coordination**: City scans should be coordinated with the vendor to avoid triggering security alerts or rate limiting. The vendor will whitelist City scanner IP addresses to prevent blocking.

**Scan Frequency**: The City may conduct scans as frequently as desired, though quarterly scans are recommended to validate vendor scanning results.

**Scan Results Sharing**: The City will share scan results with the vendor to facilitate remediation. Results should be provided in standard formats (CSV, XML, PDF reports).

### 3.3 Vulnerability Prioritization

Identified vulnerabilities are prioritized by severity using the Common Vulnerability Scoring System (CVSS):

| Severity | CVSS Score | Description | Examples |
|----------|------------|-------------|----------|
| **Critical** | 9.0 - 10.0 | Easily exploitable vulnerabilities that could lead to complete system compromise | Remote code execution, SQL injection with admin access, authentication bypass |
| **High** | 7.0 - 8.9 | Vulnerabilities that could significantly impact confidentiality, integrity, or availability | Privilege escalation, sensitive data exposure, XSS with session theft |
| **Medium** | 4.0 - 6.9 | Vulnerabilities with limited impact or requiring specific conditions to exploit | Information disclosure, CSRF, insecure configurations |
| **Low** | 0.1 - 3.9 | Vulnerabilities with minimal impact or requiring significant attacker resources | Verbose error messages, missing security headers, outdated software versions |

**Risk Context**: CVSS scores are adjusted based on business context, data sensitivity, and compensating controls. A vulnerability with high CVSS score may be downgraded if effective mitigations are in place.

---

## 4. Penetration Testing

### 4.1 Vendor-Conducted Penetration Testing

The vendor conducts annual penetration testing by qualified third-party security firms:

**Testing Frequency**: Annually, or after major system changes (architecture redesign, new features, infrastructure migration)

**Testing Firm Qualifications**:
- Certified penetration testers (OSCP, GPEN, CEH)
- Proven track record in web application and cloud security testing
- Professional liability insurance
- Non-disclosure agreements protecting City data

**Testing Methodology**: Testing follows industry-standard methodologies including:
- **OWASP Testing Guide**: Web application security testing methodology
- **PTES (Penetration Testing Execution Standard)**: Comprehensive penetration testing framework
- **NIST SP 800-115**: Technical guide to information security testing and assessment

**Testing Phases**:
1. **Planning**: Define scope, objectives, and rules of engagement
2. **Reconnaissance**: Gather information about target systems
3. **Vulnerability Analysis**: Identify potential security weaknesses
4. **Exploitation**: Attempt to exploit identified vulnerabilities
5. **Post-Exploitation**: Assess impact and potential for further compromise
6. **Reporting**: Document findings, risks, and remediation recommendations

### 4.2 City-Conducted Penetration Testing

The City may conduct its own penetration testing using internal security personnel or contracted third parties:

**Testing Approaches**:

**Black Box Testing**: Testers have no prior knowledge of system internals, simulating external attacker perspective. This approach validates external security controls and identifies vulnerabilities discoverable through reconnaissance.

**Gray Box Testing**: Testers have limited knowledge (user credentials, API documentation), simulating insider threat or compromised account scenarios. This approach efficiently identifies vulnerabilities while maintaining realistic attack scenarios.

**White Box Testing**: Testers have full knowledge including source code, architecture diagrams, and credentials, enabling comprehensive security review. This approach identifies maximum vulnerabilities but may not reflect real-world attack scenarios.

**Testing Scope**:
- **Network Penetration Testing**: Assess network security controls, firewall rules, network segmentation
- **Web Application Testing**: Identify OWASP Top 10 vulnerabilities, business logic flaws, authentication/authorization issues
- **API Security Testing**: Test API authentication, authorization, input validation, rate limiting
- **Mobile Application Testing**: If mobile apps are developed, test client-side security, API communication, data storage
- **Social Engineering**: Test user awareness through phishing simulations, phone pretexting (with approval)

### 4.3 Penetration Testing Report

Penetration testing results are documented in comprehensive reports including:

**Executive Summary**: High-level overview of testing scope, methodology, key findings, and overall risk assessment suitable for non-technical stakeholders.

**Technical Findings**: Detailed description of each identified vulnerability including:
- Vulnerability description and impact
- Affected systems and components
- Steps to reproduce
- Proof-of-concept code or screenshots
- CVSS score and risk rating
- Remediation recommendations

**Attack Narrative**: Chronological description of successful attack chains demonstrating how vulnerabilities could be chained together for greater impact.

**Remediation Roadmap**: Prioritized list of remediation actions with estimated effort and recommended timelines.

**Compliance Mapping**: Mapping of findings to relevant compliance requirements (NIST, OWASP, industry standards).

---

## 5. Vulnerability Remediation

### 5.1 Remediation Timelines

Identified vulnerabilities are remediated according to severity-based timelines:

| Severity | Remediation Timeline | Notification Requirement |
|----------|---------------------|-------------------------|
| **Critical** | 7 calendar days | Immediate notification to City within 24 hours |
| **High** | 30 calendar days | Notification within 72 hours, remediation plan within 1 week |
| **Medium** | 90 calendar days | Notification in monthly security report |
| **Low** | Next release cycle | Included in release notes |

**Timeline Extensions**: If remediation cannot be completed within standard timelines due to technical complexity or dependency on third parties, the vendor will:
1. Notify the City of the delay
2. Provide detailed explanation of remediation challenges
3. Propose compensating controls to mitigate risk
4. Establish revised remediation timeline

**Compensating Controls**: When immediate remediation is not feasible, temporary compensating controls may be implemented:
- Web Application Firewall (WAF) rules to block exploit attempts
- Network segmentation to limit vulnerability exposure
- Enhanced monitoring and alerting for exploitation attempts
- Temporary disabling of vulnerable features (if business impact is acceptable)

### 5.2 Remediation Verification

After vulnerabilities are remediated, verification testing confirms effectiveness:

**Vendor Verification**: The vendor conducts internal verification testing to confirm vulnerabilities are resolved and remediation does not introduce new issues.

**City Verification**: The City may conduct independent verification testing to validate remediation. Verification results are shared with the vendor.

**Regression Testing**: Remediation changes undergo regression testing to ensure existing functionality is not broken and new vulnerabilities are not introduced.

### 5.3 False Positive Handling

Some vulnerability scan findings may be false positives (reported vulnerabilities that do not actually exist):

**False Positive Review**: The vendor reviews all scan findings and identifies potential false positives based on system configuration, compensating controls, or scanner limitations.

**Documentation**: False positives are documented with technical justification explaining why the finding does not represent a real vulnerability.

**Scanner Tuning**: Vulnerability scanners are tuned to reduce false positives through configuration adjustments, custom rules, and scanner updates.

**City Review**: The City may review false positive determinations and request additional evidence or testing to confirm findings are not exploitable.

---

## 6. Vulnerability Disclosure

### 6.1 City Vulnerability Reporting

When the City discovers vulnerabilities during assessments, findings are reported to the vendor through secure channels:

**Reporting Contact**:  
**Email**: security@manus.im  
**Encryption**: PGP encryption recommended for sensitive findings  
**Response Time**: Vendor acknowledges reports within 24 hours

**Report Contents**:
- Vulnerability description
- Affected system/component
- Steps to reproduce
- Proof-of-concept (if available)
- Severity assessment
- Recommended remediation

### 6.2 Vendor Vulnerability Response

Upon receiving vulnerability reports, the vendor follows a structured response process:

**Acknowledgment** (24 hours): Confirm receipt of vulnerability report and assign tracking identifier

**Initial Assessment** (72 hours): Analyze vulnerability, validate reproducibility, assess severity and impact

**Remediation Plan** (1 week): Develop remediation approach, estimate effort, establish timeline

**Status Updates**: Provide regular status updates to the City (weekly for critical/high, bi-weekly for medium/low)

**Remediation Completion**: Notify City when vulnerability is remediated and verification testing is complete

### 6.3 Responsible Disclosure

If vulnerabilities are discovered by external security researchers or the public, the vendor follows responsible disclosure principles:

**Disclosure Coordination**: Work with researchers to understand vulnerability details and coordinate disclosure timing

**Patch Development**: Develop and test patches before public disclosure to prevent exploitation

**Public Disclosure**: After patches are deployed, publish security advisories describing vulnerabilities and remediation steps

**City Notification**: Notify the City of externally reported vulnerabilities immediately upon discovery, regardless of public disclosure status

---

## 7. Patch Management

### 7.1 Security Patch Process

Security patches are applied systematically to address identified vulnerabilities:

**Patch Sources**:
- Operating system security updates (Ubuntu, Debian)
- Application framework updates (Node.js, React, Express)
- Dependency updates (npm packages, system libraries)
- Database patches (MySQL, TiDB)
- Infrastructure patches (container runtime, orchestration)

**Patch Testing**: All security patches undergo testing before production deployment:
1. **Staging Deployment**: Deploy patches to staging environment
2. **Functional Testing**: Verify application functionality is not broken
3. **Security Testing**: Confirm vulnerability is remediated
4. **Performance Testing**: Ensure patches do not degrade performance
5. **Rollback Preparation**: Prepare rollback procedures in case of issues

**Patch Deployment**:
- **Critical Patches**: Deployed within 24-48 hours after testing
- **High Patches**: Deployed within 1 week after testing
- **Medium/Low Patches**: Deployed during scheduled maintenance windows

### 7.2 Dependency Management

Application dependencies (npm packages, system libraries) are continuously monitored for vulnerabilities:

**Automated Scanning**: Dependency vulnerability scanning runs on every code commit and daily in production

**Vulnerability Alerts**: Automated alerts notify development team of new dependency vulnerabilities

**Update Strategy**:
- **Patch Updates**: Minor version updates (1.2.3 → 1.2.4) applied automatically after automated testing
- **Minor Updates**: Minor version updates (1.2.0 → 1.3.0) applied after manual review and testing
- **Major Updates**: Major version updates (1.0.0 → 2.0.0) planned and tested thoroughly due to breaking changes

**Dependency Pinning**: Production dependencies use exact version pinning to prevent unexpected updates

### 7.3 Patch Notifications

The City is notified of security patches that may affect system availability or functionality:

**Notification Contents**:
- Description of vulnerability being patched
- Severity and potential impact
- Patch deployment schedule
- Expected downtime (if any)
- Rollback plan

**Notification Timing**:
- **Planned Patches**: 1 week advance notice for scheduled maintenance
- **Emergency Patches**: 24-48 hours notice for critical vulnerabilities
- **Zero-Day Patches**: Immediate notification with deployment as soon as possible

---

## 8. Continuous Security Monitoring

### 8.1 Security Metrics

The vendor tracks security metrics to measure security posture and improvement over time:

| Metric | Target | Measurement Frequency |
|--------|--------|----------------------|
| Mean Time to Detect (MTTD) vulnerabilities | < 7 days | Monthly |
| Mean Time to Remediate (MTTR) critical vulnerabilities | < 7 days | Monthly |
| Percentage of systems with current patches | > 95% | Weekly |
| Number of open vulnerabilities by severity | Trend downward | Monthly |
| Failed login attempts per day | < 100 | Daily |
| Rate limit violations per day | < 50 | Daily |

**Metrics Reporting**: Security metrics are included in monthly security reports provided to the City.

### 8.2 Threat Intelligence

The vendor monitors threat intelligence sources to stay informed of emerging threats:

**Intelligence Sources**:
- CVE (Common Vulnerabilities and Exposures) database
- NVD (National Vulnerability Database)
- Security mailing lists (Full Disclosure, Bugtraq)
- Vendor security advisories (Node.js, npm, MySQL)
- Security research blogs and conferences

**Threat Response**: When threat intelligence indicates vulnerabilities affecting the BCA system, the vendor:
1. Assesses applicability to system configuration
2. Evaluates risk and potential impact
3. Implements mitigations or patches
4. Notifies City if high-severity threats are identified

### 8.3 Security Audits

In addition to vulnerability assessments, periodic security audits review security controls and compliance:

**Audit Frequency**: Annual comprehensive security audits

**Audit Scope**:
- Access control policies and implementation
- Audit logging completeness and retention
- Encryption implementation (in transit and at rest)
- Backup and disaster recovery procedures
- Incident response preparedness
- Security training and awareness
- Third-party security management

**Audit Reports**: Audit findings are documented and shared with the City, including identified gaps and remediation plans.

---

## 9. Security Testing Tools

### 9.1 Recommended Tools

The following tools are recommended for security assessments of the BCA system:

**Vulnerability Scanners**:
- **Nessus Professional**: Comprehensive vulnerability scanner with extensive plugin library
- **Qualys VMDR**: Cloud-based vulnerability management platform
- **OpenVAS**: Open-source vulnerability scanner

**Web Application Scanners**:
- **OWASP ZAP**: Open-source web application security scanner
- **Burp Suite Professional**: Industry-standard web security testing platform
- **Acunetix**: Automated web vulnerability scanner

**Penetration Testing Tools**:
- **Metasploit Framework**: Exploitation framework for penetration testing
- **Kali Linux**: Linux distribution with pre-installed security tools
- **Cobalt Strike**: Commercial penetration testing platform

**Code Analysis Tools**:
- **SonarQube**: Static code analysis for security vulnerabilities
- **ESLint Security Plugin**: JavaScript security linting
- **npm audit**: Dependency vulnerability scanning

### 9.2 Tool Configuration

Security testing tools should be configured appropriately for the BCA system:

**Scanner Authentication**: Provide authenticated scan credentials to enable testing of authenticated functionality

**Scan Throttling**: Configure scanners to limit request rate to avoid triggering rate limiting or causing performance impact

**False Positive Tuning**: Configure scanners to reduce false positives based on system architecture and security controls

**Custom Checks**: Develop custom scanner checks for application-specific security requirements

---

## 10. Compliance & Standards

### 10.1 Security Standards Alignment

Vulnerability assessment and remediation processes align with recognized security standards:

**NIST Cybersecurity Framework**: Vulnerability management supports the "Identify" and "Protect" functions by identifying and mitigating security weaknesses.

**OWASP ASVS (Application Security Verification Standard)**: Web application security testing follows OWASP ASVS requirements for different security levels.

**CIS Controls**: Vulnerability management implements CIS Control 7 (Continuous Vulnerability Management) including regular scanning, prioritization, and remediation.

**PCI DSS**: If payment card data is processed, vulnerability management meets PCI DSS requirements for quarterly vulnerability scans and annual penetration testing.

### 10.2 Assessment Documentation

All security assessments are documented and retained for compliance and audit purposes:

**Documentation Retention**: Assessment reports, scan results, and remediation records are retained for 7 years

**Documentation Access**: The City has access to all assessment documentation upon request

**Confidentiality**: Assessment documentation is treated as confidential and protected from unauthorized disclosure

---

## 11. Contact Information

### 11.1 Vendor Security Team

**Security Contact**: security@manus.im  
**Response Time**: 24 hours for critical issues, 72 hours for non-critical  
**Escalation**: For urgent security issues, contact vendor account manager

### 11.2 City Security Team

**Security Contact**: [To be provided by City]  
**Assessment Coordination**: [To be provided by City]  
**Incident Response**: [To be provided by City]

---

## 12. Document Revision History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | December 2024 | Manus AI | Initial vulnerability assessment procedures |

**Next Review Date**: June 2025

**Approval**:
- Vendor Security Team: _________________ Date: _______
- City IT Security Manager: _________________ Date: _______

---

## Appendix A: Vulnerability Severity Matrix

| Finding Type | CVSS Range | Remediation Timeline | Example Vulnerabilities |
|--------------|------------|---------------------|------------------------|
| Critical | 9.0-10.0 | 7 days | Unauthenticated RCE, SQL injection with admin access, authentication bypass |
| High | 7.0-8.9 | 30 days | Authenticated RCE, privilege escalation, sensitive data exposure, stored XSS |
| Medium | 4.0-6.9 | 90 days | CSRF, reflected XSS, information disclosure, insecure direct object reference |
| Low | 0.1-3.9 | Next release | Missing security headers, verbose errors, outdated software (no known exploits) |

## Appendix B: Penetration Testing Checklist

**Pre-Testing**:
- [ ] Scope defined and approved
- [ ] Rules of engagement documented
- [ ] Testing window scheduled
- [ ] Notification sent to stakeholders
- [ ] Emergency contacts identified
- [ ] Backup and rollback procedures verified

**Testing Phase**:
- [ ] Reconnaissance completed
- [ ] Vulnerability scanning completed
- [ ] Manual testing completed
- [ ] Exploitation attempts documented
- [ ] Access maintained for post-exploitation analysis
- [ ] Evidence collected (screenshots, logs, proof-of-concept)

**Post-Testing**:
- [ ] All test accounts and backdoors removed
- [ ] System integrity verified
- [ ] Testing report drafted
- [ ] Findings reviewed with vendor
- [ ] Remediation plan developed
- [ ] Lessons learned documented

## Appendix C: Sample Vulnerability Report Template

```
VULNERABILITY REPORT

Report ID: VUL-2024-001
Date: [Date]
Reported By: [Name/Organization]
Severity: [Critical/High/Medium/Low]
CVSS Score: [0.0-10.0]

VULNERABILITY DETAILS:
Title: [Brief description]
Affected System: [System/component]
Affected Versions: [Version numbers]

DESCRIPTION:
[Detailed description of vulnerability]

IMPACT:
[Potential impact if exploited]

STEPS TO REPRODUCE:
1. [Step 1]
2. [Step 2]
3. [Step 3]

PROOF OF CONCEPT:
[Code, screenshots, or detailed demonstration]

REMEDIATION:
[Recommended fix or mitigation]

REFERENCES:
[CVE numbers, security advisories, research papers]
```
